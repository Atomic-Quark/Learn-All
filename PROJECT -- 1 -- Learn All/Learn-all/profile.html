<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - Learn All</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
</head>

<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay"
        class="fixed inset-0 bg-primary z-[9999] flex items-center justify-center transition-opacity duration-500">
        <div class="text-center">
            <div
                class="loading-spinner w-16 h-16 border-4 border-accent border-t-transparent rounded-full animate-spin mb-4 mx-auto">
            </div>
            <h2 class="text-2xl font-bold animate-pulse">Loading Profile...</h2>
        </div>
    </div>

    <nav class="navbar glass">
        <div class="container flex items-center justify-between">
            <a href="index.html" class="logo flex items-center gap-2">
                <div class="logo-icon"><i class="fas fa-user-circle"></i></div>
                <span class="logo-text">Profile</span>
            </a>
            <div class="flex items-center gap-6">
                <div class="nav-links hidden md:flex gap-6">
                    <a href="index.html" class="nav-link">Home</a>
                    <a href="projects.html" class="nav-link">Projects</a>
                    <a href="about.html" class="nav-link">About</a>
                    <a href="contact.html" class="nav-link">Contact</a>
                    <a href="ai-chat.html" class="nav-link">AI Chat</a>
                </div>
                <div class="theme-toggle" id="theme-toggle"><i class="fas fa-moon"></i></div>
            </div>
        </div>
    </nav>

    <main class="container pt-24 pb-12">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- User Card -->
            <div class="lg:col-span-1">
                <div class="card text-center sticky top-24">
                    <div class="w-32 h-32 mx-auto rounded-full bg-gradient-to-br from-accent to-purple-600 p-1 mb-4">
                        <div
                            class="w-full h-full rounded-full bg-primary flex items-center justify-center overflow-hidden">
                            <i class="fas fa-user text-6xl text-white/50"></i>
                        </div>
                    </div>
                    <h1 id="profile-name" class="text-2xl font-bold mb-1">Guest User</h1>
                    <p id="profile-email" class="text-sec text-sm mb-6">guest@example.com</p>

                    <div class="flex justify-center gap-2 mb-6">
                        <span class="px-3 py-1 rounded-full bg-white/5 text-xs font-mono border border-white/10">Level
                            1</span>
                        <span
                            class="px-3 py-1 rounded-full bg-accent/20 text-accent text-xs font-mono border border-accent/20">Novice</span>
                    </div>

                    <a href="settings.html" class="btn btn-outline w-full mb-2"><i class="fas fa-cog"></i> Edit
                        Profile</a>
                    <button id="logout-btn" class="btn btn-ghost w-full text-red-500 hover:bg-red-500/10"><i
                            class="fas fa-sign-out-alt"></i> Logout</button>
                </div>
            </div>

            <!-- Stats & Activity -->
            <div class="lg:col-span-2 space-y-8">
                <!-- Stats Grid -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="card bg-gradient-to-br from-orange-500/10 to-red-500/10 border-orange-500/20">
                        <div class="flex items-center gap-4">
                            <div
                                class="w-12 h-12 rounded-xl bg-orange-500/20 flex items-center justify-center text-orange-500 text-2xl">
                                <i class="fas fa-fire"></i>
                            </div>
                            <div>
                                <h3 class="text-2xl font-bold" id="stat-streak">0</h3>
                                <p class="text-xs text-sec uppercase tracking-wider">Day Streak</p>
                            </div>
                        </div>
                    </div>

                    <div class="card bg-gradient-to-br from-blue-500/10 to-cyan-500/10 border-blue-500/20">
                        <div class="flex items-center gap-4">
                            <div
                                class="w-12 h-12 rounded-xl bg-blue-500/20 flex items-center justify-center text-blue-500 text-2xl">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div>
                                <h3 class="text-2xl font-bold" id="stat-completed">0</h3>
                                <p class="text-xs text-sec uppercase tracking-wider">Completed</p>
                            </div>
                        </div>
                    </div>

                    <div class="card bg-gradient-to-br from-purple-500/10 to-pink-500/10 border-purple-500/20">
                        <div class="flex items-center gap-4">
                            <div
                                class="w-12 h-12 rounded-xl bg-purple-500/20 flex items-center justify-center text-purple-500 text-2xl">
                                <i class="fas fa-star"></i>
                            </div>
                            <div>
                                <h3 class="text-2xl font-bold" id="stat-xp">0</h3>
                                <p class="text-xs text-sec uppercase tracking-wider">Total XP</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Activity Graph -->
                <div class="card mb-8">
                    <h3 class="text-lg font-bold mb-4">Contribution Activity</h3>
                    <div class="overflow-x-auto pb-2">
                        <div id="streak-graph" class="contribution-grid"
                            style="display: grid; grid-template-rows: repeat(7, 1fr); grid-auto-flow: column; gap: 4px; width: max-content;">
                        </div>
                    </div>
                    <div class="flex items-center justify-end gap-2 mt-2 text-xs text-sec">
                        <span>Less</span>
                        <div class="w-3 h-3 rounded-sm" style="background-color: #1e1e1e"></div>
                        <div class="w-3 h-3 rounded-sm" style="background-color: rgba(139, 92, 246, 0.4)"></div>
                        <div class="w-3 h-3 rounded-sm" style="background-color: rgba(139, 92, 246, 0.7)"></div>
                        <div class="w-3 h-3 rounded-sm" style="background-color: var(--accent)"></div>
                        <span>More</span>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div>
                    <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                        <i class="fas fa-history text-accent"></i> Recent Activity
                    </h2>
                    <div class="card space-y-4" id="activity-list">
                        <!-- Populated by JS -->
                        <div class="text-center py-8 text-sec">
                            <p>No recent activity found.</p>
                            <a href="index.html" class="text-accent hover:underline mt-2 inline-block">Start
                                Learning</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Load User Data
            const user = JSON.parse(localStorage.getItem('user'));
            if (user) {
                document.getElementById('profile-name').textContent = user.name || 'User';
                document.getElementById('profile-email').textContent = user.email || 'user@example.com';
            } else {
                // Redirect to login if not logged in (optional, or show guest)
                // window.location.href = 'login.html';
            }

            // Load Stats
            const streak = localStorage.getItem('user_streak') || 0;
            const progress = JSON.parse(localStorage.getItem('user_progress')) || {};
            const completedCount = Object.values(progress).filter(p => p.completed).length;
            const xp = completedCount * 100 + (parseInt(streak) * 10);

            document.getElementById('stat-streak').textContent = streak;
            document.getElementById('stat-completed').textContent = completedCount;
            document.getElementById('stat-xp').textContent = xp;

            // Render Graph
            if (typeof renderStreakGraph === 'function') {
                renderStreakGraph();
            }

            // Logout
            document.getElementById('logout-btn').addEventListener('click', () => {
                if (confirm('Are you sure you want to logout?')) {
                    localStorage.removeItem('user');
                    window.location.href = 'login.html';
                }
            });
        });
    </script>
</body>

</html>